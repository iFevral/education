<section>
    <h1>Profile</h1>

    <div class="data-container" *ngIf="!isEditMode">
        <div class="avatar"
            [style.background]="'url('+ this.userModel.avatar +')'">
        </div>
        <button mat-button (click)="avatarPathForm.click()">
            <mat-icon>create</mat-icon>
        </button>
        <input class="avatar-path-form" #avatarPathForm (change)="setAvatar($event)" type="file">
        <h3>First name: {{userModel.firstName}}</h3>
        <h3>Last Name: {{userModel.lastName}}</h3>
        <h3>E-mail: {{userModel.email}}</h3>
        <div class="input-form-group">
            <button mat-flat-button color="primary" (click)="changeMode()">Edit</button>
        </div>
    </div>

    <div class="edit-form-container" *ngIf="isEditMode">
        <form [formGroup]="editForm" novalidate>
            <div class="input-form-group">
                <mat-form-field>
                    <input placeholder="First name" name="passwordInput" matInput formControlName="firstName"
                        [(ngModel)]="userModel.firstName">
                </mat-form-field>
                <div class="alert alert-danger"
                    *ngIf="editForm.controls['firstName'].invalid && editForm.controls['firstName'].touched">
                    First name can`t be empty
                </div>
            </div>

            <div class="input-form-group">
                <mat-form-field>
                    <input placeholder="Last name" name="passwordInput" matInput formControlName="lastName"
                        [(ngModel)]="userModel.lastName">
                </mat-form-field>
                <div class="alert alert-danger"
                    *ngIf="editForm.controls['lastName'].invalid && editForm.controls['lastName'].touched">
                    Last name can`t be empty
                </div>
            </div>

            <div class="input-form-group">
                <mat-form-field>
                    <input type="email" placeholder="Email" name="emailInput" matInput formControlName="email"
                        [(ngModel)]="userModel.email">
                </mat-form-field>
                <div class="alert alert-danger"
                    *ngIf="editForm.controls['email'].invalid && editForm.controls['email'].touched">
                    Email can`t be empty
                </div>
            </div>

            <div class="input-form-group">
                <mat-form-field>
                    <input type="password" placeholder="Password" name="passwordInput" matInput
                        formControlName="oldPassword" [(ngModel)]="userModel.password">
                </mat-form-field>
            </div>

            <div class="input-form-group">
                <mat-form-field>
                    <input type="password" placeholder="New password" name="passwordInput" matInput
                        formControlName="newPassword" [(ngModel)]="userModel.newPassword">
                </mat-form-field>
                <div class="alert alert-danger"
                    *ngIf="editForm.controls['newPassword'].value && editForm.controls['newPassword'].invalid && editForm.controls['newPassword'].touched">
                    Minimum password size is 6
                </div>
            </div>

            <div class="input-form-group">
                <mat-form-field>
                    <input type="password" placeholder="Confirm Password" name="passwordInput" matInput
                        formControlName="confirmPassword" [(ngModel)]="passwordConfirmationFormValue">
                </mat-form-field>
                <div class="alert alert-danger" *ngIf=" editForm.controls['confirmPassword'].touched &&
                    editForm.controls['confirmPassword'].value != editForm.controls['newPassword'].value">
                    Passwords must be the same
                </div>
            </div>

            <div class="input-form-group">
                <button mat-flat-button color="primary" (click)="editProfile(); changeMode()"
                    [disabled]="editForm.invalid || editForm.controls['confirmPassword'].value != editForm.controls['newPassword'].value">Ok</button>
                <button mat-flat-button color="primary" (click)="cancelEditProfile(); changeMode()">Cancel</button>
            </div>
        </form>
    </div>

</section>